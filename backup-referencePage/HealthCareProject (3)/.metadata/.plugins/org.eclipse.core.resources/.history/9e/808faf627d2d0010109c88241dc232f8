package testClasses;
import java.awt.AWTException;
import org.openqa.selenium.Keys;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;
import pageClasses.StartVisitPage;
import utilities.BaseClass;

public class StartVisitTest extends BaseClass {
	
	@Test(priority=2,groups={"sanity"},retryAnalyzer = utilities.RetryAnalyzer.class)	
	public void StartVisit() throws InterruptedException, AWTException
	{
		LoginTest.executeLoginTest();
		Thread.sleep(10000);
		/* click on Appointment link */
		addExplicitWait(StartVisitPage.ClickOnLinkAppointment());
		driver.findElement(StartVisitPage.ClickOnLinkAppointment()).click();
		
		/* click on Create new Appointment button */
		addExplicitWait(StartVisitPage.ClickOnCreateNewAppointment());
		driver.findElement(StartVisitPage.ClickOnCreateNewAppointment()).click();
		
		
		/* click on Searchbox */
		addExplicitWait(StartVisitPage.ClickOnSearchBox());
		WebElement search_box = driver.findElement(StartVisitPage.ClickOnSearchBox());
		search_box.sendKeys("Harry2 dsouza2");
		search_box.sendKeys(Keys.RETURN);
		Thread.sleep(5);
		
		/* Click on Start Visit button */
		addExplicitWait(StartVisitPage.ClickOnStartVisitButton());
		driver.findElement(StartVisitPage.ClickOnStartVisitButton()).click();
		
		/* Click on New button */
		addExplicitWait(StartVisitPage.ClickOnNew());
		driver.findElement(StartVisitPage.ClickOnNew()).click();
		
		/* click on visit location */		
		addExplicitWait(StartVisitPage.ClickOnVisitLocation()); 	  		
		driver.findElement(StartVisitPage.ClickOnVisitLocation()).click();
	
		/* Pause to allow dropdown to open */
        Thread.sleep(1000);
        StartVisitPage.slectOptionVisitLocation();
        
        scrollDownDivTag();
			
		/* select Visit Type */		
		addExplicitWait(StartVisitPage.SelectVisitType());
		driver.findElement(StartVisitPage.SelectVisitType()).click();
				
		/* select Punctuality */		
		addExplicitWait(StartVisitPage.clickOnPunctuality()); 	  		
		driver.findElement(StartVisitPage.clickOnPunctuality()).click();
	
		/* Pause to allow dropdown to open */
        //Thread.sleep(1000);
        StartVisitPage.slectOptionPunctuality();

        /* enter policyNumber */
        addExplicitWait(StartVisitPage.enterPolicyNum());
	    driver.findElement(StartVisitPage.enterPolicyNum()).sendKeys("123456");
		
	    //Thread.sleep(3000);
		  /* click on StartVisit Button */
	     addExplicitWait(StartVisitPage.clickOnStartVisitButton());
	     driver.findElement(StartVisitPage.clickOnStartVisitButton()).click();
			
		 //Thread.sleep(4000);
		 
		 /* validating the Start visit button should not show it should hide, once submit the the details info(location,viist type,punctuality of the start page */
		addExplicitWait1(StartVisitPage.validateStartVisitButton());
		try {
			  WebElement btnStartvisit = driver.findElement(StartVisitPage.validateStartVisitButton());
			  if (!btnStartvisit.isDisplayed()) {
			        System.out.println("Test Passed: Start Visit button is hidden.");
			  } else {
			        throw new AssertionError("Test Failed: Start Visit button is still visible.");
			  }
		} catch (NoSuchElementException e) {
			    System.out.println("Test Passed: Start Visit button was removed from the DOM.");
		}
			
			//Thread.sleep(3000);
	}
	

}
